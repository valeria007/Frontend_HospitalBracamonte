<!DOCTYPE >
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Administrador</title>
<%- include("../partials/head") -%>	
<link rel="stylesheet" href="/sweetalert2/dist/sweetalert2.min.css">
<style>
  .info2{ border-radius:100%; float: left; height:80px; width:80px; }
  .info2 .icon{ font-size:50px; color:#FFFFFF; float:left; margin-right:50px; margin:15px 9px 9px 18px;}
  .vertical-alignment-helper {
      display:table;
      height: 100%;
      margin-left: 41%;
    }
    .vertical-align-center {
      /* To center vertically */
      display: table-cell;
      vertical-align: middle;
      text-align: center;
    }
</style>
<script type="text/javascript">
	// este scrip es para verificar si esta el token en local starge
	var data = localStorage.getItem('data')
	if (data == null){
		window.location.replace('/')
  }
  function delete_local_storage(){
		localStorage.removeItem('data');
		localStorage.removeItem('url');
  }
  setTimeout(()=>{
    delete_local_storage()
    //window.location.replace('/')
  },500000);
</script>
</head>
<body class="light_theme  fixed_header left_nav_fixed">
  <div class="wrapper" id="reghoras">
    <div class="header_bar">
      <div class="brand">
        <div class="logo" style="display:block"><span class="theme_color">Hospital</div>
      </div>
      <div class="header_top_bar">
        <a href="javascript:void(0);" class="menutoggle"> <i class="fa fa-bars"></i> </a> <span>&nbsp;</span>
        <div class="top_right_bar">
          <div class="user_admin dropdown"> <a href="javascript:void(0);" data-toggle="dropdown"><img src="/images/admin.png" /><span class="user_adminname"><span>&nbsp;&nbsp;</span><%=data_doc.data.personal.nombre%> <%=data_doc.data.personal.apellidop%></span> <b class="caret"></b> </a>
            <ul class="dropdown-menu">
              <div class="top_pointer"></div>
              <li> <a data-target="#myModalCerrar" data-toggle="modal" ><i class="fa fa-power-off"></i>Salir</a> </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="inner">
      <div class="left_nav">
        <div class="left_nav_slidebar">
          <ul>
            <li ><a href="javascript:void(0);"><i class="fa fa-home"></i> Home <span class="plus"><i class="fa fa-plus"></i></span> </a>
              <ul >
                <li> <a href="/home/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle theme_color"></i> <b >Inicio</b> </a> </li>
              </ul>
            </li>
            <li > <a href="javascript:void(0);"> <i class="fa fa-users icon"></i>Admin Usuarios<span class="plus"><i class="fa fa-plus"></i></span></a>
              <ul  >
                <li> <a href="/usuarios/usuarios/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle theme_color"></i> <b >Registros</b> </a> </li>
              </ul>
            </li>
            <li class="left_nav_active theme_border"> <a href="javascript:void(0);"> <i class="fa fa-clipboard"></i>Servicios<span class="left_nav_pointer"></span><span class="plus"><i class="fa fa-plus"></i></span></a>
              <ul class="opened" style="display:block">
                <li> <a href="/cuaderno/especialidad/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b>Especialidades</b> </a> </li>
                <li> <a href="/cuaderno/Cuadernos/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b class="theme_color">Cuadernos</b> </a> </li>
                <li> <a href="/salas/salas/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b>Salas</b> </a> </li>
              </ul>
            </li>
            <li> <a href="javascript:void(0);"> <i class="fa fa-folder-open-o"></i> Reportes <span class="plus"><i class="fa fa-plus"></i></span> </a>
              <ul>
                <li> <a href="/paciente_Inter/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b >Reporte de Pacientes</b> </a> </li>
                <li> <a href="/pacientead/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b >Reporte de Farmacia</b></a> </li>
                <li> <a href="/usuarios/roles1/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b >Reporte de Person.</b> </a> </li>
                <li> <a href="/cuaderno/recuadernos/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b >Reporte de Cuadr.</b> </a> </li>
                <li> <a href="/cuaderno/repespecialidad/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b>Reporte de Espc.</b> </a> </li>
              </ul>
            </li>
            <li> <a href="javascript:void(0);"> <i class="fa fa-cogs"></i>CFG del Sistema<span class="plus"><i class="fa fa-plus"></i></span></a>
              <ul>
                <li> <a href="/backup/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle"></i> <b>Backup</b> </a> </li>
                <li> <a href="/role/role/<%=data_doc.data.token_id%>"> <span>&nbsp;</span> <i class="fa fa-circle "></i> <b >Regs. Roles</b> </a> </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <div class="contentpanel">
        <div class="container clear_both padding_fix col-lg-8">
          <br>
          <div class="row">
            <div class="col-lg-12 ">
              <div id="main-content" class=" block-web">
                <div class="header">
                    <div class="info2 blue_symbols"><i class="fa fa-calendar-o icon"></i></div>
                    <h3 class="content-header ">Administración de Turnos</h3>
                </div>
                <div class="page-content">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="block-web">
                        <div class="header">
                          <div class="actions"> 
                            <a class="minimize" data-toggle="collapse" data-target="#demo" ><i class="fa fa-chevron-down" style="color: blue;"></i></a> 
                            <a class="refresh" href=""><i class="fa fa-repeat" style="color: blue;"></i></a>
                          </div>
                        </div>
                        <br>
                       
                        <div class="porlets-contents">
                          
                          <div id="demo" class="collapse in">
                            
                            <form class="form-horizontal group-border-dashed" action="/cuaderno/turnos/<%=id_fechas%>/<%=data_doc.data.token_id%>/<%=id_anterior%>/<%=id_volver_fechas%>" method="POST" parsley-validate novalidate>  
				                      <div class="form-group">
                                <label class="control-label col-md-4">Día de atención :</label>
                                <div class="col-md-3 ">
                                  <select  class="form-control" id="source" name="diasAten"required placeholder="" >
                                    <option value="" selected disabled hidden>--Seleccione--</option>
                                    <option value="Lunes">LUNES</option>
                                    <option value="Martes">MARTES</option>
                                    <option value="Miercoles">MIERCOLES</option>
                                    <option value="Jueves">JUEVES</option>
                                    <option value="Viernes">VIERNES</option>
                                    <option value="Sabado">SABADO</option>
                                    <option value="Domingo">DOMINGO</option>
                                  </select><br>
                                </div>                      
                              </div><!--/form-group--> 
                              <div class="form-group">
                                <label class="control-label col-md-4">Turno :</label>
                                <div class="col-md-3 ">
                                  <select class="form-control" id="source" name="turno" required placeholder="">                               
                                    <option value="" selected disabled hidden>--Seleccione--</option>
                                    <option value="Mañanas">MAÑANAS</option>
                                    <option value="Tardes">TARDES</option>
                                    <option value="Noches">NOCHES</option>
                                  </select><br>
                                </div>                      
                              </div><!--/form-group--> 
                              <div class="form-group">
                                <div class="col-md-4"> 
                                  <button type="submit" class="btn btn-success btn-icon">Guardar <span>&nbsp;</span><i class="fa fa-check-square"></i></button>
                                  <div class="btn-group">
                                      <button data-toggle="dropdown" class="btn btn-info dropdown-toggle" type="button"><i class="fa fa-reply"></i><span>&nbsp;</span>Volver<span class="caret"></span></button>
                                    <ul role="menu" class="dropdown-menu">
                                      <li><a href="/cuaderno/cuadernos1/<%=data_doc.data.token_id%>"><i class="fa fa-folder-open "></i><span>&nbsp;</span>Cuadernos </a></li>
                                      <!--<li><a href="/cuaderno/volver_docCuaderno/<%=id_anterior%>/<%=data_doc.data.token_id%> ">Asignación Medico</a></li>
                                      <li><a href="/cuaderno/volverFechas/<%=id_volver_fechas%>/<%=data_doc.data.token_id%>/<%=id_anterior%>">Fechas</a></li>
                                      <li><a href="/home/<%=data_doc.data.token_id%>">Home</a></li>-->
                                    </ul>
                                  </div>               
                                </div>
                              </div><!--/form-group--> 
                            </form>
                          </div>
                          <br><br>
                          
                          <div class="porlets-content">
                            <div class="table-responsive">
                              <table  class="display table table-bordered table-striped" id="dynamic-table">
                                <thead>
                                  <tr>
                                    <th class="text-center">#</th>
                                    <th class="text-center">Día de Atención</th>
                                    <th class="text-center">Turno</th>
                                    <th class="text-center">Opciones</th>
                                  </tr>
                                    </thead>
                                    <tbody>
                                      <% for (var i=0; i< resp.length; i++) { %>
                                      <tr>
                                        <td class="text-center"><%=i+1%></td>
                                        <td class="text-center"><%=resp[i].diasAten%></td>
                                        <td class="text-center"><%=resp[i].turno%></td>
                                        <td class="text-center">
                                          <a @click="turn_id(<%=resp[i].id%>), turn = '<%=resp[i].turno%>'" data-target="#myModal2" data-toggle="modal"  data-toggle="tooltip" class="btn  tooltips" data-original-title="Dar Fichas y Horas"><i class="fa fa-plus-square "></i></a>
                                          <!--<a href="/cuaderno/horarios_turnos/<%=resp[i].id%>/<%=resp[i].turno%>" data-toggle="tooltip" class="btn  tooltips" data-original-title="Dar_horas"><i class="fa fa-plus-square"></i></a>
                                          <a href="/cuaderno/delturno/<%=resp[i].id%>" data-toggle="tooltip" class="btn  tooltips" data-original-title="Eliminar"><i  class=" fa fa-trash-o red"></i></a><span>&nbsp;</span>-->
                                          <a @click="idT='<%=resp[i].id%>'" data-target="#myModal3" data-toggle="modal"data-toggle="tooltip" class="btn  tooltips" data-original-title="Eliminar"><i  class=" fa fa-trash-o red"></i></a><span>&nbsp;</span>
                                        </td>
                                      </tr>
                                      <% } %>
                                    <tbody>
                              </table>
                              <!--<textarea name="" id="" cols="30" rows="10">{{$data}}</textarea>-->
                            </div>
                          </div>
                        </div>
                        <!--/porlets-content-->
                      </div>
                      <!--/block-web-->
                    </div>
                    <!--/col-md-12-->
                  </div>
                  <!--/row-->
                </div>
                <!--/page-content end-->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">Intervalo de Atención</h4>
            <a @click="ver = !ver" class="btn btn-info btn-icon" ><i class="fa fa-plus-square"></i><span>&nbsp;</span>Nuevo</a>
            <div class="center">
              <span style="color: blue">{{msg}}</span>
              <span style="color: red">{{msg_false}}</span>
            </div>
          </div>
          <div class="modal-body"> 
            <template v-if="ver">
                <form class="form-horizontal"  parsley-validate novalidate>
                    <p class="center" style="color:red;">*Asegurece de haber eliminado todas las Horas anteriores*</p>
                    <div class="form-group">
                      <label class="col-sm-4 control-label">Cantidad de Fichas:</label>
                      <div class="col-sm-6">
                        <select  class="form-control" v-model="cantiFicha">
                          <option value="" selected disabled hidden>--Seleccione--</option>
                          <option>1</option>
                          <option>2</option>
                          <option>3</option>
                          <option>4</option>
                          <option>5</option>
                          <option>6</option>
                          <option>7</option>
                          <option>8</option>
                          <option>9</option>
                          <option>10</option>
                          <option>11</option>  
                          <option>12</option>      
                          <option>13</option>      
                          <option>14</option>      
                          <option>15</option>
                          <option>16</option> 
                          <option>17</option>                                     
        
                        </select>
                        <p style="color:red;">*Cantidad Maxima de Fichas del Médico*</p>
                      </div>
                    </div> 
                    <div class="form-group">
                      <label  class="col-sm-4 control-label">Intervalo de horas:</label>
                      <div class="col-sm-6">
                        <select class="form-control" id="source" v-model="intervalo">
                          <option value="" selected disabled hidden>--Seleccione--</option>
                          <option value="15"> 15 minutos </option>
                          <option value="20"> 20 minutos </option>
                          <option value="30"> 30 minutos </option>
                        </select>
                      </div>
                    </div>
                    <div class="form-group">
                      <div class="col-sm-offset-2 col-sm-10">
                        <a @click="eliminar" class="btn btn-info btn-icon">Eliminar Todo <span>&nbsp;</span><i class="fa fa-minus-square"></i></a></td> <span>&nbsp;&nbsp;&nbsp;</span>
                        <a @click="sumar_horas"  class="btn btn-success btn-icon" >Guardar <span>&nbsp;</span><i class="fa fa-check-square"></i></a><span>&nbsp;&nbsp;&nbsp;</span>
                        <button type="reset"class="btn btn-danger btn-icon" data-dismiss="modal">Cancelar <span>&nbsp;</span><i class="fa fa-times"></i></button>
                      </div>
                    </div>
                  </form>
            </template>
            <template v-else>
                <table  class="table table-bordered" >
                    <thead>
                        <tr>
                          <th class="text-center">N° Fichas</th>
                          <th class="text-center">Día Atención</th>
                         
                        </tr>
                    </thead>
                    <tbody v-for="(list, index) in list_horas">
                      <tr >
                        <td class="text-center">{{index+1}}</td>
                        <td class="text-center">{{list.hora}}</td>
                      </tr>
                    </tbody>
                </table>
            </template>
            
          </div>
        </div>
      </div>
    </div>
    <!-------MODALLLLL-------->
    <div class="modal fade" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="vertical-alignment-helper">
        <div class="modal-dialog vertical-align-center modal-sm ">
          <div class="modal-content">
            <div class="modal-body">
              <div class="center">
                <i  class="fa fa-exclamation-triangle red fa-6x"></i>
              </div>
              <div class="center">
                <h5><b>¿Estás seguro ?</b></h5>
                <p>Eliminar el turno....</p>
              </div>
            </div>
            <div class="modal-footer">
              <div class="center">
                <a v-bind:href="'/cuaderno/delturno/'+idT+'/<%=id_fechas%>/<%=data_doc.data.token_id%>/<%=id_anterior%>/<%=id_volver_fechas%>'"  class="btn btn-success"><i class="fa fa-check"></i><span>&nbsp;</span>Sí, Confirmar</a>
                <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i><span>&nbsp;</span>No, Cancelar</button>
              </div>
            </div>
          </div>
        </div>
      </div> 
    </div>
  </div>
  <div class="modal fade" id="myModalCerrar" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    
    <div class="vertical-alignment-helper">
        <div class="modal-dialog vertical-align-center modal-sm ">
          <div class="modal-content">
            <br>
              <div class="center">
                <i><img src="/images/salir.gif" width="100" height="100" /></i>
              </div>
              <div class="center">
                <h5><b>¿Cerrar Sesión?</b></h5>
              </div>
            <div class="modal-footer">
              <div class="center">
                <a href="/delete_token/<%=data_doc.data.token_id%>" onclick="delete_local_storage()" class="btn btn-success"><i class="fa fa-check"></i><span>&nbsp;</span>Sí, Confirmar</a>
                <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i><span>&nbsp;</span>No, Cancelar</button>
              </div>
            </div>
          </div>
        </div>
    </div> 
  </div>


 
<%- include("../partials/scripts") -%>
<script src="/sweetalert2/dist/sweetalert2.min.js"></script>
<script src="/url/export.js"></script>
<script src="/js/vue/reg_horas.js"></script>

<script>
  /*  <%if(msg) { %> */
    /*  <%if(msg.data.success == false) { %> */
         msg_false()
         function msg_false(){
           swal.fire(
             'Error!',
             '<label style="color:red;">'+`<%=msg.data.data_p%>`+'</label>',
             'error'
           )
         }
     /* <% } else {%> */
         msg_true()
         function msg_true(){
           swal.fire(
             'Success!',
             '<label style="color:green;">'+ `<%=msg.data.data_p%>` +'</label>',
             'success'
           )
         }
    /*  <% } %> */
  /*  <% } %> */
</script>

</body>
</html>
